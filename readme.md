# Генератор карты сайта

## Общее описание проекта

Этот проект представляет собой генератор карты сайта (sitemap), который создает структурированную навигационную карту веб-сайта. Он позволяет автоматически анализировать структуру сайта, собирать URL-адреса и формировать иерархическое дерево для удобного отображения.

## Основные компоненты

### 1. Генератор Sitemap
- **SitemapGenerator** - основной класс, который управляет процессом генерации
- Использует очередь для обхода URL-адресов с ограничением одновременных запросов (максимум 10)
- Обрабатывает вложенные URL и формирует структуру сайта

### 2. Основные методы
- `generateSitemap(options)` - основной метод генерации структуры сайта
- `buildTree(items)` - строит иерархическое дерево из элементов
- `renderTree(tree, level)` - отрисовывает дерево в HTML-формате
- `generateHtmlTree(siteUrl)` - генерирует HTML-представление карты сайта

### 3. Структура данных
- `htmlTreeStructure` - массив элементов для построения дерева
- `sitemapData` - данные для XML-генерации
- `visitedUrls` - множество уже обработанных URL

## Работа с URL

### Валидация URL
```javascript
validateUrl(url) {
    try {
        new URL(url);
        return true;
    } catch (error) {
        return false;
    }
}
```

### Исключение URL по паттернам
```javascript
shouldExcludeUrl(url, patterns) {
    // Проверяет соответствует ли URL шаблону для исключения
}
```

## Форматы вывода

### XML-формат (sitemap.xml)
- Содержит информацию о каждом URL: loc, lastmod, changefreq, priority
- Используется поисковыми роботами для индексации сайта

### HTML-формат (sitemap.html)
- Генерируется с использованием Bootstrap 4 для визуального представления
- Содержит структурированный список ссылок с иерархией
- Пример HTML-структуры:
```html
<ul>
    <li>
        <a href="https://example.com">Главная страница</a>
        <ul>
            <li><a href="https://example.com/page1">Страница 1</a></li>
        </ul>
    </li>
</ul>
```

## Параметры конфигурации

### Командная строка
- `--changefreq=weekly` - частота обновления (weekly, daily, monthly и т.д.)
- `--save-path=/путь/к/сохранению/` - путь для сохранения файлов
- `--exclude-patterns=/admin,/private` - шаблоны исключаемых URL

## Обработка данных

### Основные этапы обработки:
1. Валидация домена
2. Инициализация очереди URL-адресов
3. Обход страниц с ограничением одновременных запросов
4. Парсинг HTML для извлечения заголовков и ссылок
5. Формирование структуры данных
6. Генерация XML и HTML-выходных файлов

## Папки и файлы проекта

### Структура файлов:
```
project/
├── src/                     # Исходный код
│   ├── SitemapGenerator.js  # Основной класс
├── README.md                # Основная документация
└── sitemap.js               # Точка входа в приложение
```

## Особенности реализации

### Параллелизм
- Используется пул из 10 одновременных запросов
- Обработка в.batch-ах для оптимизации производительности
- Уникальные URL-адреса исключаются из повторной обработки

### Сериализация данных
- Данные сохраняются в XML формате по стандарту sitemap.org
- HTML-представление использует Bootstrap 4 для адаптивного дизайна
- Пути к файлам автоматически создаются при необходимости

## Пример использования

Основное использование
```bash
node sitemap.js https://example.com
```

С указанием частоты обновления
```bash
node sitemap.js https://example.com --changefreq=monthly
```

С указанием пути сохранения
```bash
node sitemap.js https://example.com --save-path=/var/www/sitemap.xml
```

С исключением по маскам
```bash
node sitemap.js https://example.com --exclude-patterns="admin,.pdf"
```

Все вместе
```bash
node sitemap.js https://example.com --changefreq=weekly --save-path=/var/www/sitemap.xml --exclude-patterns="/admin,.pdf"
```

Это создаст:
1. `sitemap.xml` - XML-карту сайта
2. `sitemap.html` - HTML-представление с иерархией

## Технические требования

### Зависимости
- Node.js (версия 14+)
- axios для HTTP-запросов
- cheerio для парсинга HTML
- fs и path для работы с файловой системой

### Системные требования
- Минимум 2 ГБ оперативной памяти
- Свободное место на диске для сохранения результатов
- Доступ к интернету для обхода сайта

## Установка
1. Склонируйте репозиторий:
```bash
git clone <url-репозитория>
```

2. Перейдите в директорию проекта:
```bash
cd <название-проекта>
```

3.Установите зависимости:
```bash
npm install
```

## Сборка исполняемого файла

```bash
pkg . \
  --target node16-win-x64 \
  --target node16-linux-x64 \
  --target node16-macos-x64 \
  --out-path dist
```

## Оптимизация производительности

### Лимиты
- Максимально 10 одновременных HTTP-запросов
- Уникальные URL-адреса исключаются из повторной обработки
- Иерархическая структура предотвращает бесконечный обход

### Обработка ошибок
- Логирование всех исключений при работе с файлами
- Проверка корректности путей к файлам
- Обработка ошибок сетевых запросов